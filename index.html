import React, { useState } from 'react';
import { 
  Star, 
  Heart, 
  Shield, 
  Gift, 
  Sun, 
  Crown, 
  Play, 
  X, 
  Trophy, 
  Map as MapIcon, 
  User,
  CheckCircle2,
  Lock
} from 'lucide-react';

// Dados dos níveis do jogo baseados nos ensinamentos bíblicos
const LEVELS = [
  {
    id: 1,
    title: "O Jardim do Amor",
    theme: "Amor a Deus e ao Próximo",
    description: "Ajude o personagem a plantar sementes de bondade no jardim, aprendendo que Deus é amor.",
    icon: Heart,
    color: "bg-red-500",
    shadow: "shadow-red-700",
    textColor: "text-red-500",
    unlocked: true,
    completed: true,
    stars: 3
  },
  {
    id: 2,
    title: "A Arca de Noé",
    theme: "Obediência aos Pais e a Deus",
    description: "Siga as instruções para construir a arca! Quem obedece aos pais, alegra o coração de Deus.",
    icon: Shield,
    color: "bg-orange-500",
    shadow: "shadow-orange-700",
    textColor: "text-orange-500",
    unlocked: true,
    completed: false,
    stars: 0
  },
  {
    id: 3,
    title: "O Bom Samaritano",
    theme: "Generosidade e Ajuda",
    description: "Colete moedas pelo caminho não para guardar, mas para ajudar os viajantes que precisam!",
    icon: Gift,
    color: "bg-green-500",
    shadow: "shadow-green-700",
    textColor: "text-green-500",
    unlocked: false,
    completed: false,
    stars: 0
  },
  {
    id: 4,
    title: "Davi e o Gigante",
    theme: "Respeito e Coragem",
    description: "Use a pedra do respeito para vencer o gigante do orgulho. Respeite os mais velhos e seus amigos!",
    icon: Star,
    color: "bg-blue-500",
    shadow: "shadow-blue-700",
    textColor: "text-blue-500",
    unlocked: false,
    completed: false,
    stars: 0
  },
  {
    id: 5,
    title: "O Resgate",
    theme: "Salvação e Vida Eterna",
    description: "Atravesse a ponte da Cruz para alcançar a cidade de luz. Jesus é o caminho para a vida eterna!",
    icon: Sun,
    color: "bg-yellow-400",
    shadow: "shadow-yellow-600",
    textColor: "text-yellow-600",
    unlocked: false,
    completed: false,
    stars: 0
  },
  {
    id: 6,
    title: "Passos de Jesus",
    theme: "O Caráter de Cristo",
    description: "O desafio final! Siga as pegadas brilhantes para aprender a ser manso, humilde e verdadeiro como Jesus.",
    icon: Crown,
    color: "bg-purple-500",
    shadow: "shadow-purple-700",
    textColor: "text-purple-500",
    unlocked: false,
    completed: false,
    stars: 0
  }
];

export default function App() {
  const [selectedLevel, setSelectedLevel] = useState(null);
  const [coins, setCoins] = useState(150);
  const [totalStars, setTotalStars] = useState(3);

  // Componente de Nuvem Decorativa para o fundo (Estilo Mario)
  const Cloud = ({ top, left, delay }) => (
    <div 
      className="absolute bg-white rounded-full opacity-80"
      style={{
        top, left,
        width: '100px', height: '40px',
        animation: `float 10s ease-in-out infinite ${delay}s alternate`
      }}
    >
      <div className="absolute -top-4 left-4 w-12 h-12 bg-white rounded-full" />
      <div className="absolute -top-6 left-10 w-16 h-16 bg-white rounded-full" />
    </div>
  );

  return (
    <div className="min-h-screen bg-sky-300 relative overflow-hidden font-sans select-none">
      {/* Estilos de Animação embutidos */}
      <style>{`
        @keyframes float {
          0% { transform: translateX(0px); }
          100% { transform: translateX(30px); }
        }
        @keyframes bounce-slight {
          0%, 100% { transform: translateY(0); }
          50% { transform: translateY(-5px); }
        }
      `}</style>

      {/* Fundo Decorativo */}
      <Cloud top="10%" left="5%" delay={0} />
      <Cloud top="25%" left="70%" delay={2} />
      <Cloud top="60%" left="15%" delay={1} />
      <Cloud top="75%" left="80%" delay={3} />

      {/* Montanhas no rodapé */}
      <div className="absolute bottom-0 left-0 right-0 h-48 flex justify-center items-end opacity-50 z-0">
        <div className="w-96 h-96 bg-green-500 rounded-t-full translate-y-32 -ml-20"></div>
        <div className="w-[500px] h-[500px] bg-green-400 rounded-t-full translate-y-48 z-10"></div>
        <div className="w-96 h-96 bg-green-600 rounded-t-full translate-y-32 -mr-20"></div>
      </div>

      {/* HEADER HUD */}
      <header className="relative z-20 flex justify-between items-center p-4 md:p-6 bg-white/20 backdrop-blur-sm border-b-4 border-white/40">
        <div className="flex items-center gap-3">
          <div className="w-14 h-14 bg-blue-500 border-4 border-white rounded-full flex items-center justify-center shadow-lg">
            <User size={28} className="text-white" />
          </div>
          <div>
            <h1 className="text-2xl font-black text-white drop-shadow-md uppercase tracking-wider">
              Herói da Fé
            </h1>
            <p className="text-blue-900 font-bold bg-white/50 px-2 rounded-md inline-block text-sm">Nível 2</p>
          </div>
        </div>

        <div className="flex gap-4">
          <div className="flex items-center gap-2 bg-yellow-400 border-b-4 border-yellow-600 rounded-full px-4 py-2 font-black text-white text-xl shadow-md">
            <Star className="fill-white" size={24} />
            <span>{totalStars}</span>
          </div>
          <div className="flex items-center gap-2 bg-yellow-300 border-b-4 border-yellow-500 rounded-full px-4 py-2 font-black text-yellow-900 text-xl shadow-md hidden sm:flex">
            <div className="w-6 h-6 bg-yellow-500 rounded-full border-2 border-yellow-200 flex items-center justify-center text-xs">C</div>
            <span>{coins}</span>
          </div>
        </div>
      </header>

      {/* MAIN GAME MAP */}
      <main className="relative z-10 max-w-2xl mx-auto pt-12 pb-32 px-4 flex flex-col items-center">
        
        {/* Caminho conectando as fases */}
        <div className="absolute top-24 bottom-48 w-4 bg-orange-200/50 rounded-full z-0 border-x-2 border-dashed border-orange-400/50"></div>

        <div className="flex flex-col-reverse gap-16 md:gap-24 w-full">
          {LEVELS.map((level, index) => {
            const Icon = level.icon;
            // Efeito zigue-zague no mapa
            const isLeft = index % 2 === 0;
            const alignmentClass = isLeft ? 'self-start ml-8 md:ml-16' : 'self-end mr-8 md:mr-16';

            return (
              <div key={level.id} className={`relative flex flex-col items-center ${alignmentClass}`}>
                
                {/* Título Flutuante do Nível */}
                <div className="bg-white px-4 py-1 rounded-full border-2 border-slate-200 shadow-sm mb-3 absolute -top-10 text-center w-max">
                  <span className="font-bold text-slate-700 text-sm">{level.id}. {level.title}</span>
                </div>

                {/* Botão do Nível (Estilo Node do Mario) */}
                <button 
                  onClick={() => level.unlocked && setSelectedLevel(level)}
                  className={`
                    relative w-20 h-20 md:w-24 md:h-24 rounded-full flex items-center justify-center z-10 transition-transform
                    ${level.unlocked ? 'cursor-pointer hover:scale-110' : 'cursor-not-allowed grayscale opacity-80'}
                    ${level.color} border-4 border-white ${level.shadow} border-b-8 active:border-b-4 active:translate-y-1
                  `}
                  style={{ animation: level.unlocked && !level.completed ? 'bounce-slight 2s infinite' : 'none' }}
                >
                  {level.unlocked ? (
                    level.completed ? (
                      <CheckCircle2 size={40} className="text-white drop-shadow-md" />
                    ) : (
                      <Icon size={40} className="text-white drop-shadow-md" />
                    )
                  ) : (
                    <Lock size={32} className="text-slate-200" />
                  )}

                  {/* Estrelas conquistadas embaixo do botão */}
                  {level.unlocked && (
                    <div className="absolute -bottom-6 flex gap-1">
                      {[1, 2, 3].map(star => (
                        <Star 
                          key={star} 
                          size={16} 
                          className={star <= level.stars ? "fill-yellow-400 text-yellow-500" : "fill-slate-300 text-slate-400"} 
                        />
                      ))}
                    </div>
                  )}
                </button>
              </div>
            );
          })}
        </div>
      </main>

      {/* FOOTER NAVIGATION */}
      <footer className="fixed bottom-0 left-0 right-0 p-4 bg-white border-t-4 border-slate-200 z-30 flex justify-around md:justify-center md:gap-16">
        <button className="flex flex-col items-center gap-1 text-blue-500 transition-transform active:scale-95">
          <MapIcon size={28} className="drop-shadow-sm" />
          <span className="font-bold text-xs">Mundo</span>
        </button>
        <button className="flex flex-col items-center gap-1 text-slate-400 hover:text-blue-500 transition-transform active:scale-95">
          <Trophy size={28} />
          <span className="font-bold text-xs">Prêmios</span>
        </button>
      </footer>

      {/* LEVEL MODAL (Pop-up antes de jogar) */}
      {selectedLevel && (
        <div className="fixed inset-0 bg-sky-900/60 backdrop-blur-sm flex items-center justify-center z-50 p-4">
          <div className="bg-white rounded-3xl w-full max-w-md overflow-hidden border-8 border-white shadow-2xl transform transition-all animate-in zoom-in-95">
            
            {/* Cabecalho do Modal */}
            <div className={`${selectedLevel.color} p-6 relative flex flex-col items-center text-center`}>
              <button 
                onClick={() => setSelectedLevel(null)}
                className="absolute top-4 right-4 bg-white/20 hover:bg-white/40 rounded-full p-2 transition-colors"
              >
                <X size={24} className="text-white" />
              </button>
              
              <div className="w-20 h-20 bg-white rounded-full flex items-center justify-center shadow-inner mb-4">
                <selectedLevel.icon size={48} className={selectedLevel.textColor} />
              </div>
              
              <h2 className="text-2xl font-black text-white uppercase tracking-wide drop-shadow-sm">
                {selectedLevel.title}
              </h2>
              <div className="bg-white/20 px-3 py-1 rounded-full mt-2 inline-block">
                <span className="text-white font-bold text-sm flex items-center gap-2">
                  <Star size={16} className="fill-white" />
                  Tema: {selectedLevel.theme}
                </span>
              </div>
            </div>

            {/* Corpo do Modal */}
            <div className="p-6 bg-slate-50 flex flex-col items-center text-center">
              <p className="text-slate-600 font-medium text-lg mb-6">
                "{selectedLevel.description}"
              </p>

              {/* Recompensas */}
              <div className="flex gap-2 mb-8">
                {[1, 2, 3].map(star => (
                  <div key={star} className="w-12 h-12 bg-slate-200 rounded-full flex items-center justify-center border-b-4 border-slate-300">
                    <Star 
                      size={24} 
                      className={star <= selectedLevel.stars ? "fill-yellow-400 text-yellow-500 drop-shadow" : "fill-slate-300 text-slate-400"} 
                    />
                  </div>
                ))}
              </div>

              {/* Botão Jogar */}
              <button 
                className={`
                  w-full py-4 rounded-2xl flex items-center justify-center gap-3 font-black text-xl uppercase tracking-wider text-white transition-all
                  ${selectedLevel.color} border-b-[6px] ${selectedLevel.shadow} active:border-b-[0px] active:translate-y-[6px]
                `}
                onClick={() => {
                  alert(`Iniciando a fase: ${selectedLevel.title}! Aqui abriria o motor do jogo (ex: Unity, Phaser, ou canvas HTML5).`);
                  setSelectedLevel(null);
                }}
              >
                <Play className="fill-white" size={28} />
                Jogar Agora
              </button>
            </div>
          </div>
        </div>
      )}
    </div>
  );
}
